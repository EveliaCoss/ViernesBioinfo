---
title: "Introducción a R"
subtitle: "VieRnes de Bioinformatica"
author: "Sofía Salazar"
institute: "VieRnes de Bioinformatica"
date: "2023/09/29"
output:
  xaringan::moon_reader:
    css: 
      - xaringan-themer.css
      - css/mi-tema.css
      - default
      - rladies
      - rladies-fonts 
    lib_dir: libs
    seal: false
    self_contained: true
    nature:
      highlightStyle: googlecode
      highlightLines: true
      countIncrementalSlides: false
      ratio: 16:9
      beforeInit: "macros.js"
      slideNumberFormat: |
        <div class="progress-bar-container">
          <div class="progress-bar" style="width: calc(%current% / %total% * 100%);">
          </div>
        </div>

---
```{r setup, include = FALSE}
# Setup chunk
# Paquetes a usar
#options(htmltools.dir.version = FALSE) cambia la forma de incluir código, los colores

library(knitr)
library(tidyverse)
library(xaringanExtra)
library(icons)
library(fontawesome)
library(emo)

# set default options
opts_chunk$set(collapse = TRUE,
               dpi = 300,
               warning = FALSE,
               error = FALSE,
               comment = "#")

top_icon = function(x) {
  icons::icon_style(
    icons::fontawesome(x),
    position = "fixed", top = 10, right = 10
  )
}

knit_engines$set("yaml", "markdown")

# Con la tecla "O" permite ver todas las diapositivas
xaringanExtra::use_tile_view()
# Agrega el boton de copiar los códigos de los chunks
xaringanExtra::use_clipboard()

# Crea paneles impresionantes 
xaringanExtra::use_panelset()

# Para compartir e incrustar en otro sitio web
xaringanExtra::use_share_again()
xaringanExtra::style_share_again(
  share_buttons = c("twitter", "linkedin")
)

# Funcionalidades de los chunks, pone un triangulito junto a la línea que se señala
xaringanExtra::use_extra_styles(
  hover_code_line = TRUE,         #<<
  mute_unhighlighted_code = TRUE  #<<
)

# Agregar web cam

xaringanExtra::use_webcam()
```

```{r xaringan-editable, echo=FALSE}
# Para tener opciones para hacer editable algun chunk
xaringanExtra::use_editable(expires = 1)
# Para hacer que aparezca el lápiz y goma
xaringanExtra::use_scribble()
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
# Establecer colores para el tema
library(xaringanthemer)
#style_mono_light(base_color = "#562457")
```

class: title-slide, middle, center
background-image: url(figures/liigh_unam_logo.png) 
background-position: 10% 50%
background-size: 15%


.center-column[
# `r rmarkdown::metadata$title`
### `r rmarkdown::metadata$subtitle`

####`r rmarkdown::metadata$author` 
#### `r rmarkdown::metadata$date`
]

---
## .center[Sobre mí]
.left-col[ 
### `r fontawesome::fa("dna", fill = "#181818")` Sofía Salazar Magaña

Estudiante de la Licenciatura en Ciencias Genómicas @ [ENES-J UNAM](https://www.enesjuriquilla.unam.mx/?page_id=2136)

Asistente de investigación @ [RegGenoLab](https://liigh.unam.mx/), LIIGH UNAM

Asistente de investigación @ [Im Lab](https://hakyimlab.org/), The University of Chicago 


[`r fontawesome::fa("github")` GitHub: SophSM](https://github.com/SophSM)
]

.center-col[
### `r fontawesome::fa("star", fill = "#181818")` Miembro

- [LupusRGMX](https://twitter.com/LupusRgmx)

- [Proyecto JAGUAR](https://twitter.com/PJaguarLATAM)
]

.right-col[
<img src="figures/LAB-logo.png", height = "150">
<img src = "figures/lupus-logo.png">
<img src = "figures/jaguar-logo.png">
]
---
class: center, middle

`r fontawesome::fa("laptop-file", height = "3em")`
# Dia 2. Introducción a R

---

## ¿Qué es R?

R es un entorno de desarrollo de software libre y lenguaje de programación. 

**¿Por qué utilizar R?**

Es comúnmente ampliamente para la computación estadística, gráfica, y de machine learning. Ofrece una amplia variedad de **funciones estadísticas** (modelos lineales y no lineales, pruebas estadísticas clásicas, análisis de series de tiempo, clasificación, agrupamiento, etc.), gráficas.

Además, existen numerosas librerías que nos pemiten realizar análisis y gráficas, incluyendo para análisis genómicos.

.center[
<img src = "figures/r-logo.png", height = "150">
]
---

## ¿Cómo instalamos R?

Para installar R, debemos de entrar a la página de [CRAN](https://cran.r-project.org/) "The Comprehensive R Archive Network". Al installar R, descargamos también ~ 25 paqueterías/librerías.

**CRAN** es una red en la que se archivan todas las versiones de R base, así como todos los paquetes para R que han pasado por un proceso de revisión riguroso, realizado por el CRAN Team.

.center[
<img src = "figures/download-r.png", height = "320">
]

---

## ¿Qué es RStudio?

RStudio es un **entorno de desarrollo integrado (IDE)** para R. Un IDE es una aplicación que ayuda a los programadores a desarrollar código de una manera eficiente. Nos proporciona una interfaz para poder editar código fuente, herramientas de ambiente, visualización, terminal y consola.

**RStudio Desktop** es una aplicación que se utiliza ampliamente para desarrollar programas en R, pero también podemos accesar al IDE de RStudio a través con [RStudio Server](https://posit.co/download/rstudio-server/), a través de un navegador web.

.center[
<img src = "figures/rstudio-logo.png", height = "250">
]
---
## ¿Cómo descargamos RStudio?

Podemos descargar RStudio desde [esta página](https://posit.co/download/rstudio-desktop/). Ya realizamos el paso 1: Install R. 

En el paso 2: Install R studio, nos debería detectar el sistema operativo, descarguemos la versión recomendada en el botón **azul** y sigamos las instrucciones de instalación.
.center[
<img src = "figures/download-rstudio.png", height = "400">
]
---
## Las partes de RStudio


---
## Cambiando el aspecto de RStudio
Podemos cambiar la forma en que se ve la aplicación desde **Editar > Preferencias > Apariencia**, escogemos el tema que nos guste y damos click en **Aplicar** y luego **OK** 

.center[
<img src = "figures/apariencia-rstudio.png", height = "400">
]

---

## Comenzando con R y RStudio: 1. R Project

Al comenzar a trabajar con R y RStudio, ya sea para crear un programa para un proyecto, crear una aplicación, presentación, blog, paquete, etc, es recomendado crear un **R project**.

Al crear un R project, se creará un folder en donde estarán todos los documentos, fotos, scripts, etc. que usaremos en ese projecto. Es una forma organizada y práctica de trabajar con R.

---
## ¿Cómo iniciamos un R project?

Vayamos en la parte superior al menú **Archivos > Nuevo Proyecto**.
.center[
<img src = "figures/r_2.png", height = "450">]
---
## ¿Cómo iniciamos un R project?

Seleccionamos la opción de **Nuevo directorio**.
.center[
<img src = "figures/r_3.png", height = "450">]
---

## ¿Cómo iniciamos un R project?

Seleccionamos el tipo de projecto que vamos a iniciar, en nuestro caso **Nuevo proyecto**.
.center[
<img src = "figures/r_4.png", height = "450">]
---

## ¿Cómo iniciamos un R project?

Nombramos el folder que crearemos y seleccionamos en dónde queremos que se almacene. 
.center[
<img src = "figures/r_5.png", height = "450">]
---

## ¿Cómo iniciamos un R project?

¡Felicidades, acabas de crear un R project! Si vamos al folder en donde creamos nuestro proyecto, podemos observar que se creó un archivo con terminación **Rproj**, este es un archivo que contiene la configuración específica para nuestro proyecto. 

Este archivo también establece como directorio de trabajo el folder en donde iniciamos el proyecto (puedes comprobarlo desde la consola de RStudio, escribiendo el comando `getwd()`). Esto es muy conveniente puesto que así podemos asegurarnos de que vamos a acceder a los archivos que estén exclusivamente en nuestro entorno de trabajo.

```{r}
getwd()
```

Cambiar directorio de trabajo

```{r eval = F}
setwd("/Users/sofiasalazar/nuevodirectorio")
```


---
## Comenzando con nuestro proyecto: Crear un Rscript

Para comenzar a trabajar en un proyecto, necesitamos crear un archivo para escribir nuestro programa. Entra en **Archivo > Nuevo Archivo**.

Podemos ver que tenemos distintas opciones de archivos que podemos crear, en este caso vamos a crear nuestro primer Rscript.

.center[
<img src = "figures/r_6.png", height = "350">]

---
## Crear un Rscript

**¿Qué es un Rscript?** Es simplemente un archivo de texto con las instrucciones de nuestro algoritmo escritas en el lenguaje de R. También contiene nuestros comentarios escritos con `#`.

Intenta escribir tu primer Rscript en el **editor**, copiando el siguiente algoritmo para realizar una suma:

```{r, eval = F}
a <- 2
b <- 3
suma = a + b
suma
```

Selecciona todo el código, después ve a la parte superior de la ventana del **editor** y da click en el botón **Run**. Enseguida de esto, en la **consola** se ejecutará tu código y podrás ver el siguiente resultado:

.left-col[
<img src = "figures/script-R.png", height = "150">]

.right-col[
También pueden ejecutar tu código línea por línea, poniendo tu cursor al principio o al final de la linea y presionando las teclas **Control + Enter** o **Command + Enter**.
]

---
## R session

Al momento de comenzar a ejecutar líneas de código, guardar valores en variables y cargar librerías, estaremos guardando esto en nuestra "sesión de R". Esto es un "ambiente" que puedes guardar al finalizar de trabajar y lo que guardaste lo puedes cargar a Rstudio la próxima vez que vayas a continuar trabajando.

Para guardar tu sesión de R:

```{r, eval = F}
save.image(file = "/una/direccion/enTu/PC/sesionR_miPrograma.RData")
```

Para cargar tu sesión de R:

```{r, eval = F}
load(file = "/una/direccion/enTu/PC/sesionR_miPrograma.RData")
```

También puedes guardar y cargar solo alguna variable:

```{r, eval = F}
save(variable, file = "/una/direccion/enTu/PC/variable.RData")
load("/una/direccion/enTu/PC/variable.RData") # ahora "variable" estara en tu ambiente
```

---
## Buenas prácticas de programación: Set up de tu trabajo

Es buena idea comenzar **todos** tus scripts con las mismas líneas de código que indiquen lo siguiente:

- Título de tu programa
- Autor
- Fecha
- Propósito general de tu programa
- Directorio de input: aquí estan guardados los datos que vas a usar en el programa
- Directorio de output: aquí es donde vas a guardar tus resultados
- Librerías que utilizarás en el programa
- Líneas en donde cargues los datos que vas a usar

---
## Buenas prácticas de programación: Set up de tu trabajo

```{r}
# Mi programa
# Tu nombre
# Fecha: dd-mm-aaaa
# Este script ejecuta xxx utilizando como input xxx y dando como output xxx
# Input dir
indir <- "/Users/sofiasalazar/miPrograma/input/"
# Output dir
outdir <- "/Users/sofiasalazar/miPrograma/output/"
# Librerias

library(ggplot2)
library(tidyverse)

# Cargar input
datos_file <- paste0(indir,"misDatos.csv")
datos_file
```

```{r, eval = F}
datos <- read.csv(datos_file)
load(file = paste0(indir, "variable.RData"))
load(file = paste0(indir, "sesionR_miPrograma.RData"))
```

---
## ¿Qué es una librería?

En programación, una librería es una colección de código pre-escrito. Una librería contiene una "paquete" o "librería" de funciones que podemos utilizar si descargamos e importamos esa librería a nuestro programa. 

Como mencioné anteriormente, al descargar R, también descargamos una serie de librerías, llamadas **base R packages**. Sin embargo, dependiendo del problema que queramos resolver con nuestro programa, necesitaremos librerías que nos permitan hacer otras cosas.

Existen distintas formas de instalar librerías.

---
## Instalar librerías: CRAN

1. Instalación desde el repositorio de CRAN: podemos descargar paqueterías de CRAN de dos formas: 

La primera, desde consola con el siguiente comando:

```{r, eval = F}
install.packages("ggplot2")
```

La segunda, desde el menú **Herramientas > Instalar paqueterías**. En la ventana, ingresamos el nombre de la librería y click en **Instalar**. 

.center[
<img src = "figures/r_7.png", height = "250">]
---
## Instalar librerías: Bioconductor

Alternativamente, podemos instalar paqueterías de Bioconductor, que es otro repositorio de paquetes diseñados para el análisis de datos genómicos, por ejemplo para hacer análisis estadísticos, anotación, acceso a bases de datos públicas, etc.

Hay muchas librerías que están tanto en CRAN como en Bioconductor, pero también hay librerías específicas para uno de ellos. Para poder instalar desde bioconductor, necesitamos primero instalar el "instalador de bioconductor":

```{r, eval = F}
install.packages("BiocManager") # Esto es necesario solo 1 vez
```

Después, instalamos la librería que queremos y la cargamos:

```{r, eval = F}
BiocManager::install("DESeq2")
library(DESeq2)
```

Puedes ver librerías y sus manuales en la [página de Bioconductor](bioconductor.org) o cuando ingresamos en **consola**: 

```{r, eval = F}
browseVignettes("DESeq2")
```
---
## Instalar librerías: Source

Podemos instalar librerías si tienes los archivos en tu PC, esto es útil cuando no tienes acceso a internet.

```{r eval = F}
install.packages("~/Downloads/ggplot2_1.0.1.tar.gz", type="source", repos=NULL)
```

O desde GitHub:

```{r eval = F}
remotes::install_github("mitchelloharawild/icons")
```

---
## Buenas prácticas al finalizar tu programa

- **Guarda tu output**

```{r eval = F}
write.csv(datos_procesados, file = paste0(outdir, "datos_procesados.csv"))
save(datos_procesados, file = paste0(outdir, "datos_procesados.RData"))
save.image(file = paste0(outdir, "sesionR_miPrograma.RData")
```

- **Especifica qué librerías utilizaste y qué versiones**

Cuando hacemos un programa, puede que en el futuro otras personas lo quieran utilizar, sin embargo, es probable que **las librerías que usaste en el momento que escribiste el programa se hayan actualizado.**

Es por eso que **al final de TODO programa que escribas, ejecutes y escribas el resultado de correr la siguiente línea.**

```{r, eval = F}
sessionInfo()
```

Puedes intentar correr este comando tú, lo que verás impreso en consola son todas las librerías instaladas en tu sesión de R, así como **la versión**. Entonces así, si alguien quiere reproducir tus resultados en algún momento, deberá instalar las mismas versiones de las librerías que tú utilizaste.

## 

```{r}
getwd()
```

